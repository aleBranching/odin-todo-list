(()=>{"use strict";class e{static loadAddProject(){function e(e,t){const r=document.createElement("button"),c=document.createElement("span");c.classList="material-symbols-outlined",c.textContent=e;const n=document.createTextNode(t);return r.appendChild(c),r.appendChild(n),r.id=`form${t}`,r.addEventListener("click",(e=>{e.preventDefault()})),r}const t=document.createElement("form");t.id="addProjectForm";const r=document.createElement("label");r.setAttribute("for","projectName"),r.innerText="Name:";const c=document.createElement("input");c.setAttribute("type","text"),c.setAttribute("name","projectName"),c.setAttribute("id","projectName"),c.required=!0,console.log(c);const n=document.createElement("div");return n.classList="buttons",n.appendChild(e("done","Submit")),n.appendChild(e("cancel","Cancel")),t.appendChild(r),t.appendChild(c),t.appendChild(n),t}static returnProjectItem(e){const t=document.createElement("div");return t.textContent=e,t.id="projectItem",t}static returnAddProjectBTN(){const e=document.createElement("div");return e.textContent="+ Add project",e.id="projectAdder",e}}class t{static createTask(e,t){const r=document.createElement("div");r.classList="task";const c=document.createElement("div");c.classList="taskInfo";const n=document.createElement("input");n.setAttribute("type","checkbox"),n.setAttribute("name","finishedTask"),n.setAttribute("id","finishedTask");const s=document.createElement("input");s.setAttribute("type","date"),s.value=e,s.readOnly=!0;const a=document.createElement("div");a.classList="noteText",a.textContent=t,c.appendChild(n),c.appendChild(s),c.appendChild(a),r.appendChild(c);const o=document.createElement("div");o.classList="functions";const d=document.createElement("span");d.classList="material-symbols-outlined edit",d.textContent="edit";const i=document.createElement("span");return i.textContent="delete",i.classList="material-symbols-outlined delete",o.appendChild(d),o.appendChild(i),r.appendChild(o),r}static createAddTask(){const e=document.createElement("div");return e.classList="addTask",e.textContent="+ Add Task",e}static createTaskForm(){const e=document.createElement("div");e.classList="addTaskForm",e.innerHTML='\n    <form action="">\n      <div>\n        <label for="date">Date:</label>\n        <input type="date" name="taskDate" id="taskDate" />\n        <label for="Task">Task:</label>\n        <input type="text" name="taskText" id="taskText" />\n      </div>\n      <div class="taskFormButtons">\n        <button id="formSubmit">\n          <span class="material-symbols-outlined">done</span>Submit\n        </button>\n        <button id="formCancel">\n          <span class="material-symbols-outlined">cancel</span>Cancel\n        </button>\n      </div>\n    </form>\n  ';const t=e.querySelector("#formSubmit"),r=e.querySelector("#formCancel");return t.addEventListener("click",(e=>{e.preventDefault()})),r.addEventListener("click",(e=>{e.preventDefault()})),e}}class r{constructor(e){this.name=e,this.tasks=[]}setName(e){this.name=e}getName(){return this.name}getTasks(){return this.tasks}getTask(e){return this.tasks.find((t=>t.getName()===e))}removeTask(e){return this.tasks=this.tasks.filter((t=>t.getName()!==e)),this.tasks}addTask(e){return this.tasks.push(e)}}class c{constructor(e,t){this.name=e,this.date=t,this.done=!1}setDate(e){this.date=e}getDate(){return this.date}setName(e){this.name=e}getName(){return this.name}}const n=new class{constructor(){this.projects=[],this.projects.push(new r("main"))}getProjects(){return this.projects}getProjectsNotMain(){return this.projects.filter((e=>"main"!==e.getName()))}getAProject(e){return this.projects.find((t=>t.getName()===e))}addProject(e){return this.projects.push(new r(`${e}`))}};n.addProject("test"),n.getAProject("test").addTask(new c("Do homework","2023-01-19")),n.getAProject("main").addTask(new c("get rizz","2023-01-19")),n.getAProject("main").addTask(new c("Go rock climbing","2024-02-21"));const s=n;class a{static loadPage(){this.addProjectListener(),this.projectListener(),this.addTaskListener(),this.addCurrentProjects(),this.differentProjectSelected("main")}static currentProjectOBJ=s.getAProject("main");static createHeader(){const e=document.createElement("div");return e.classList="header",e}static createFooter(){const e=document.createElement("div");return e.classList="footer",e}static addProjectFormBTNS(){const t=document.querySelector("#formSubmit"),r=document.querySelector("#formCancel"),c=document.querySelector("#projectName"),n=document.querySelector("#addProjectForm");c.focus(),t.addEventListener("click",(t=>{if(t.preventDefault(),""!==c.value&&null==s.getAProject(c.value)){c.textContent="",n.replaceWith(e.returnAddProjectBTN()),this.addProjectListener();const t=document.querySelector("div#projectAdder"),r=e.returnProjectItem(c.value);t.before(r),console.log(r),s.addProject(c.value),r.addEventListener("click",(()=>{this.differentProjectSelected(c.value)}))}})),r.addEventListener("click",(t=>{t.preventDefault(),console.log("test"),n.replaceWith(e.returnAddProjectBTN()),this.addProjectListener()}))}static addCurrentProjects(){const t=s.getProjectsNotMain();console.log(t);const r=document.querySelector("div#projectAdder");t.forEach((t=>{const c=e.returnProjectItem(t.getName());r.before(c),c.addEventListener("click",(()=>{this.differentProjectSelected(t.getName())}))}))}static projectListener(){document.querySelector(".primary > div:nth-child(1)").addEventListener("click",(()=>{console.log(s.getAProject("main")),this.differentProjectSelected("main")}))}static addProjectListener(){const t=document.querySelector("#projectAdder");t.addEventListener("click",(()=>{t.replaceWith(e.loadAddProject()),this.addProjectFormBTNS()}))}static taskListener(e){const r=e.querySelector(".delete"),c=e.querySelector(".edit"),n=e.querySelector("#finishedTask"),s=e.querySelector(".noteText").textContent;r.addEventListener("click",(()=>{e.remove(),this.currentProjectOBJ.removeTask(s)})),c.addEventListener("click",(()=>{const r=e,c=e.querySelector(".noteText").textContent,n=e.querySelector('input[type="date"]').value,s=t.createTaskForm();console.log("current Text",c),console.log("current Date",n),s.querySelector("#taskText").value=c,s.querySelector("#taskDate").value=n,r.replaceWith(s),this.editTaskListener(s,r)})),n.addEventListener("click",(()=>{e.classList.toggle("checked")}))}static logicUpdateATask(e,t,r){const c=e.querySelector(".noteText").textContent,n=this.currentProjectOBJ.getTask(c);n.setName(t),n.setDate(r)}static editTaskListener(e,r){const c=e.querySelector("#formSubmit"),n=e.querySelector("#formCancel"),s=e.querySelector("#taskDate"),a=e.querySelector("#taskText");c.addEventListener("click",(c=>{if(console.log("zzzz"),c.preventDefault(),""!==s.value&&""!==s.value){const c=s.value,n=a.value;this.logicUpdateATask(r,n,c);const o=t.createTask(c,n);e.replaceWith(o),this.taskListener(o),this.currentProjectOBJ.getTask()}})),console.log(c),n.addEventListener("click",(t=>{t.preventDefault(),e.replaceWith(r),this.taskListener(r)}))}static differentProjectSelected(e){if(document.querySelector(".addTaskForm")){console.log("exists");const e=document.querySelector(".addTaskForm");console.log(e),e.querySelector("#formCancel").click()}console.log(s.getAProject(e)),this.currentProjectOBJ=s.getAProject(e),this.updateMainDivProject(e)}static updateMainDivProject(e){document.querySelector(".main").dataset.currentProject=e,console.log(this.currentProjectOBJ.getTasks()),document.querySelectorAll("div.task").forEach((e=>{e.remove()})),this.currentProjectOBJ.getTasks().forEach((e=>{console.log("A task",e);const r=document.querySelector(".addTask"),c=t.createTask(e.getDate(),e.getName());this.taskListener(c),r.before(c),this.addTaskListener()}))}static addCurrentTasks(){}static formTaskListener(){const e=document.querySelector("#formSubmit"),r=document.querySelector("#formCancel"),n=document.querySelector("#taskDate"),s=document.querySelector(".addTaskForm"),a=document.querySelector("#taskText");e.addEventListener("click",(e=>{if(console.log("zzzz"),e.preventDefault(),""!==n.value&&""!==n.value){const e=n.value,r=a.value;s.replaceWith(t.createAddTask());const o=document.querySelector(".addTask"),d=t.createTask(e,r);this.taskListener(d),o.before(d),this.addTaskListener(),this.currentProjectOBJ.addTask(new c(r,e))}})),console.log(e),r.addEventListener("click",(e=>{e.preventDefault(),s.replaceWith(t.createAddTask()),this.addTaskListener()}))}static addTaskListener(){const e=document.querySelector(".addTask");e.addEventListener("click",(r=>{if(r.preventDefault(),null==document.querySelector(".addTaskForm")){const r=t.createTaskForm();r.querySelector("input#taskDate").focus(),e.replaceWith(r),this.formTaskListener()}}))}}a.loadPage()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFjLGtCQUNsQ3NDLFFBQ1QrQyxFQUFXOUMsWUFBWStDLEdBRXZCbEYsS0FBS21GLGtCQUNQLElBRUosRUNuU0YzRCxFQUFhNEQsVSIsInNvdXJjZXMiOlsid2VicGFjazovL29kaW4tdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvbmF2YmFyLmpzIiwid2VicGFjazovL29kaW4tdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvbWFpbkNvbnRlbnQuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9wcm9qZWN0LmpzIiwid2VicGFjazovL29kaW4tdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvdGFzay5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL3RvZG9MaXN0LmpzIiwid2VicGFjazovL29kaW4tdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvdWlDb250cm9sbGVyLmpzIiwid2VicGFjazovL29kaW4tdG9kby1saXN0Ly4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCBVSUNvbnRyb2xsZXIgZnJvbSBcIi4vdWlDb250cm9sbGVyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE5hdmJhciB7XG4gIHN0YXRpYyBsb2FkQWRkUHJvamVjdCgpIHtcbiAgICBmdW5jdGlvbiBjcmVhdGVCdXR0b24oc3ltYm9sLCB0ZXh0KSB7XG4gICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgICAgc3Bhbi5jbGFzc0xpc3QgPSBcIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWRcIjtcbiAgICAgIHNwYW4udGV4dENvbnRlbnQgPSBzeW1ib2w7XG5cbiAgICAgIGNvbnN0IGJ1dHRvblRleHQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0ZXh0KTtcblxuICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKHNwYW4pO1xuICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKGJ1dHRvblRleHQpO1xuICAgICAgYnV0dG9uLmlkID0gYGZvcm0ke3RleHR9YDtcblxuICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhcInRlc3RcIik7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gYnV0dG9uO1xuICAgIH1cbiAgICAvLyBjb25zdCBhZGRQcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9qZWN0c0FkZGVyXCIpO1xuICAgIC8vIGFkZFByb2plY3QudGV4dENvbnRlbnQgPSBcIlwiO1xuXG4gICAgY29uc3QgZm9ybURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpO1xuICAgIGZvcm1EaXYuaWQgPSBcImFkZFByb2plY3RGb3JtXCI7XG5cbiAgICBjb25zdCBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcbiAgICBsYWJlbC5zZXRBdHRyaWJ1dGUoXCJmb3JcIiwgXCJwcm9qZWN0TmFtZVwiKTtcbiAgICBsYWJlbC5pbm5lclRleHQgPSBcIk5hbWU6XCI7XG5cbiAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwidGV4dFwiKTtcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIFwicHJvamVjdE5hbWVcIik7XG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJwcm9qZWN0TmFtZVwiKTtcbiAgICBpbnB1dC5yZXF1aXJlZCA9IHRydWU7XG4gICAgY29uc29sZS5sb2coaW5wdXQpO1xuXG4gICAgY29uc3QgYnV0dG9uRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBidXR0b25EaXYuY2xhc3NMaXN0ID0gXCJidXR0b25zXCI7XG5cbiAgICBidXR0b25EaXYuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uKFwiZG9uZVwiLCBcIlN1Ym1pdFwiKSk7XG4gICAgYnV0dG9uRGl2LmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbihcImNhbmNlbFwiLCBcIkNhbmNlbFwiKSk7XG5cbiAgICBmb3JtRGl2LmFwcGVuZENoaWxkKGxhYmVsKTtcbiAgICBmb3JtRGl2LmFwcGVuZENoaWxkKGlucHV0KTtcbiAgICBmb3JtRGl2LmFwcGVuZENoaWxkKGJ1dHRvbkRpdik7XG5cbiAgICAvLyBsZXQ7XG4gICAgcmV0dXJuIGZvcm1EaXY7XG4gIH1cblxuICBzdGF0aWMgcmV0dXJuUHJvamVjdEl0ZW0obmFtZSkge1xuICAgIGNvbnN0IHByb2plY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHByb2plY3QudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHByb2plY3QuaWQgPSBcInByb2plY3RJdGVtXCI7XG4gICAgcmV0dXJuIHByb2plY3Q7XG4gIH1cblxuICBzdGF0aWMgcmV0dXJuQWRkUHJvamVjdEJUTigpIHtcbiAgICBjb25zdCBhZGRQcm9qZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBhZGRQcm9qZWN0LnRleHRDb250ZW50ID0gXCIrIEFkZCBwcm9qZWN0XCI7XG4gICAgYWRkUHJvamVjdC5pZCA9IFwicHJvamVjdEFkZGVyXCI7XG4gICAgLy8gYWRkUHJvamVjdC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgLy8gYWRkUHJvamVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIC8vICAgYWRkUHJvamVjdC5yZXBsYWNlV2l0aCh0aGlzLmxvYWRBZGRQcm9qZWN0KCkpO1xuICAgIC8vICAgLy8gVUlDb250cm9sbGVyLmFkZFByb2plY3RCVE4uZm9ybUJUTlMoKTtcbiAgICAvLyAgIC8vIGFkZFByb2plY3RET00oKTtcbiAgICAvLyB9KTtcbiAgICByZXR1cm4gYWRkUHJvamVjdDtcbiAgfVxufVxuIiwiaW1wb3J0IHsgZm9ybWF0UmVsYXRpdmUgfSBmcm9tIFwiZGF0ZS1mbnNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgbWFpbkNvbnRlbnRVSSB7XG4gIHN0YXRpYyBjcmVhdGVUYXNrKGRhdGVUeHQsIHRleHQpIHtcbiAgICBjb25zdCB0YXNrRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB0YXNrRGl2LmNsYXNzTGlzdCA9IFwidGFza1wiO1xuXG4gICAgY29uc3QgdGFza0luZm9EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHRhc2tJbmZvRGl2LmNsYXNzTGlzdCA9IFwidGFza0luZm9cIjtcblxuICAgIGNvbnN0IGNoZWNrQm94SW5wdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgICBjaGVja0JveElucHQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcImNoZWNrYm94XCIpO1xuICAgIGNoZWNrQm94SW5wdC5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIFwiZmluaXNoZWRUYXNrXCIpO1xuICAgIGNoZWNrQm94SW5wdC5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImZpbmlzaGVkVGFza1wiKTtcblxuICAgIGNvbnN0IGRhdGVJbnB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuICAgIGRhdGVJbnB0LnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJkYXRlXCIpO1xuICAgIGRhdGVJbnB0LnZhbHVlID0gZGF0ZVR4dDtcbiAgICBkYXRlSW5wdC5yZWFkT25seSA9IHRydWU7XG5cbiAgICBjb25zdCB0ZXh0Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgdGV4dE5vZGUuY2xhc3NMaXN0ID0gXCJub3RlVGV4dFwiO1xuICAgIHRleHROb2RlLnRleHRDb250ZW50ID0gdGV4dDtcblxuICAgIHRhc2tJbmZvRGl2LmFwcGVuZENoaWxkKGNoZWNrQm94SW5wdCk7XG4gICAgdGFza0luZm9EaXYuYXBwZW5kQ2hpbGQoZGF0ZUlucHQpO1xuICAgIHRhc2tJbmZvRGl2LmFwcGVuZENoaWxkKHRleHROb2RlKTtcblxuICAgIHRhc2tEaXYuYXBwZW5kQ2hpbGQodGFza0luZm9EaXYpO1xuXG4gICAgY29uc3QgZnVuY3Rpb25EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGZ1bmN0aW9uRGl2LmNsYXNzTGlzdCA9IFwiZnVuY3Rpb25zXCI7XG5cbiAgICBjb25zdCBzcGFuRWRpdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgIHNwYW5FZGl0LmNsYXNzTGlzdCA9IFwibWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZCBlZGl0XCI7XG4gICAgc3BhbkVkaXQudGV4dENvbnRlbnQgPSBcImVkaXRcIjtcbiAgICBjb25zdCBzcGFuRGVsZXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgc3BhbkRlbGV0ZS50ZXh0Q29udGVudCA9IFwiZGVsZXRlXCI7XG4gICAgc3BhbkRlbGV0ZS5jbGFzc0xpc3QgPSBcIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWQgZGVsZXRlXCI7XG5cbiAgICBmdW5jdGlvbkRpdi5hcHBlbmRDaGlsZChzcGFuRWRpdCk7XG4gICAgZnVuY3Rpb25EaXYuYXBwZW5kQ2hpbGQoc3BhbkRlbGV0ZSk7XG4gICAgdGFza0Rpdi5hcHBlbmRDaGlsZChmdW5jdGlvbkRpdik7XG5cbiAgICByZXR1cm4gdGFza0RpdjtcbiAgfVxuXG4gIHN0YXRpYyBjcmVhdGVBZGRUYXNrKCkge1xuICAgIGNvbnN0IGFkZFRhc2tEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGFkZFRhc2tEaXYuY2xhc3NMaXN0ID0gXCJhZGRUYXNrXCI7XG4gICAgYWRkVGFza0Rpdi50ZXh0Q29udGVudCA9IFwiKyBBZGQgVGFza1wiO1xuICAgIHJldHVybiBhZGRUYXNrRGl2O1xuICB9XG5cbiAgc3RhdGljIGNyZWF0ZVRhc2tGb3JtKCkge1xuICAgIC8vIENoZWF0aW5nPyB5ZXMuIFRpcmVkPyB5ZXMuXG4gICAgY29uc3QgYWRkVGFza0Zvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGFkZFRhc2tGb3JtLmNsYXNzTGlzdCA9IFwiYWRkVGFza0Zvcm1cIjtcblxuICAgIGNvbnN0IGFsbEhUTUwgPSBgXG4gICAgPGZvcm0gYWN0aW9uPVwiXCI+XG4gICAgICA8ZGl2PlxuICAgICAgICA8bGFiZWwgZm9yPVwiZGF0ZVwiPkRhdGU6PC9sYWJlbD5cbiAgICAgICAgPGlucHV0IHR5cGU9XCJkYXRlXCIgbmFtZT1cInRhc2tEYXRlXCIgaWQ9XCJ0YXNrRGF0ZVwiIC8+XG4gICAgICAgIDxsYWJlbCBmb3I9XCJUYXNrXCI+VGFzazo8L2xhYmVsPlxuICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwidGFza1RleHRcIiBpZD1cInRhc2tUZXh0XCIgLz5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cInRhc2tGb3JtQnV0dG9uc1wiPlxuICAgICAgICA8YnV0dG9uIGlkPVwiZm9ybVN1Ym1pdFwiPlxuICAgICAgICAgIDxzcGFuIGNsYXNzPVwibWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZFwiPmRvbmU8L3NwYW4+U3VibWl0XG4gICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8YnV0dG9uIGlkPVwiZm9ybUNhbmNlbFwiPlxuICAgICAgICAgIDxzcGFuIGNsYXNzPVwibWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZFwiPmNhbmNlbDwvc3Bhbj5DYW5jZWxcbiAgICAgICAgPC9idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Zvcm0+XG4gIGA7XG5cbiAgICBhZGRUYXNrRm9ybS5pbm5lckhUTUwgPSBhbGxIVE1MO1xuXG4gICAgY29uc3Qgc3VibWl0QlROID0gYWRkVGFza0Zvcm0ucXVlcnlTZWxlY3RvcihcIiNmb3JtU3VibWl0XCIpO1xuICAgIGNvbnN0IGNhbmNlbEJUTiA9IGFkZFRhc2tGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybUNhbmNlbFwiKTtcblxuICAgIHN1Ym1pdEJUTi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIGNhbmNlbEJUTi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gYWRkVGFza0Zvcm07XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb2plY3Qge1xuICBjb25zdHJ1Y3RvcihuYW1lKSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLnRhc2tzID0gW107XG4gIH1cblxuICBzZXROYW1lKG5hbWUpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICB9XG5cbiAgZ2V0TmFtZSgpIHtcbiAgICByZXR1cm4gdGhpcy5uYW1lO1xuICB9XG5cbiAgZ2V0VGFza3MoKSB7XG4gICAgcmV0dXJuIHRoaXMudGFza3M7XG4gIH1cblxuICBnZXRUYXNrKHRhc2tOYW1lKSB7XG4gICAgcmV0dXJuIHRoaXMudGFza3MuZmluZCgodGFzaykgPT4gdGFzay5nZXROYW1lKCkgPT09IHRhc2tOYW1lKTtcbiAgfVxuXG4gIHJlbW92ZVRhc2sodGFza05hbWUpIHtcbiAgICB0aGlzLnRhc2tzID0gdGhpcy50YXNrcy5maWx0ZXIoKHRhc2spID0+IHRhc2suZ2V0TmFtZSgpICE9PSB0YXNrTmFtZSk7XG4gICAgcmV0dXJuIHRoaXMudGFza3M7XG4gIH1cblxuICBhZGRUYXNrKHRhc2spIHtcbiAgICByZXR1cm4gdGhpcy50YXNrcy5wdXNoKHRhc2spO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBUYXNrIHtcbiAgY29uc3RydWN0b3IobmFtZSwgZGF0ZSkge1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5kYXRlID0gZGF0ZTtcbiAgICAvLyB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHk7XG4gICAgdGhpcy5kb25lID0gZmFsc2U7XG4gIH1cblxuICBzZXREYXRlKGRhdGUpIHtcbiAgICB0aGlzLmRhdGUgPSBkYXRlO1xuICB9XG5cbiAgZ2V0RGF0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5kYXRlO1xuICB9XG5cbiAgc2V0TmFtZShuYW1lKSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgfVxuXG4gIGdldE5hbWUoKSB7XG4gICAgcmV0dXJuIHRoaXMubmFtZTtcbiAgfVxuXG4gIC8vIHNldFByaW9yaXR5KHByaW9yaXR5KSB7XG4gIC8vICAgdGhpcy5wcmlvcml0eSA9IHByaW9yaXR5O1xuICAvLyB9XG5cbiAgLy8gZ2V0UHJpb3JpdHkoKSB7XG4gIC8vICAgcmV0dXJuIHRoaXMucHJpb3JpdHk7XG4gIC8vIH1cbn1cbiIsImltcG9ydCBQcm9qZWN0IGZyb20gXCIuL3Byb2plY3RcIjtcbmltcG9ydCBUYXNrIGZyb20gXCIuL3Rhc2tcIjtcblxuY2xhc3MgVG9kb0xpc3Qge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnByb2plY3RzID0gW107XG4gICAgdGhpcy5wcm9qZWN0cy5wdXNoKG5ldyBQcm9qZWN0KFwibWFpblwiKSk7XG4gIH1cblxuICBnZXRQcm9qZWN0cygpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9qZWN0cztcbiAgfVxuXG4gIGdldFByb2plY3RzTm90TWFpbigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9qZWN0cy5maWx0ZXIoKGFQcm9qZWN0KSA9PiBhUHJvamVjdC5nZXROYW1lKCkgIT09IFwibWFpblwiKTtcbiAgfVxuXG4gIC8vIGdldFByb2plY3QobmFtZSkge1xuICAvLyAgIHRoaXMucHJvamVjdHMuZm9yRWFjaCgoYVByb2plY3QpID0+IHtcbiAgLy8gICAgIGlmIChhUHJvamVjdC5uYW1lID09PSBuYW1lKSB7XG4gIC8vICAgICAgIHJldHVybiBhUHJvamVjdDtcbiAgLy8gICAgIH1cbiAgLy8gICB9KTtcbiAgLy8gfVxuXG4gIGdldEFQcm9qZWN0KG5hbWUpIHtcbiAgICAvLyBjb25zb2xlLmxvZyhvYmplY3QpO1xuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMucHJvamVjdHNbMF0uZ2V0TmFtZSgpKTtcbiAgICByZXR1cm4gdGhpcy5wcm9qZWN0cy5maW5kKChwcm9qZWN0KSA9PiBwcm9qZWN0LmdldE5hbWUoKSA9PT0gbmFtZSk7XG4gIH1cblxuICBhZGRQcm9qZWN0KHByb2plY3QpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9qZWN0cy5wdXNoKG5ldyBQcm9qZWN0KGAke3Byb2plY3R9YCkpO1xuICB9XG59XG5cbmNvbnN0IGFUb2RvTGlzdCA9IG5ldyBUb2RvTGlzdCgpO1xuYVRvZG9MaXN0LmFkZFByb2plY3QoXCJ0ZXN0XCIpO1xuYVRvZG9MaXN0LmdldEFQcm9qZWN0KFwidGVzdFwiKS5hZGRUYXNrKG5ldyBUYXNrKFwiRG8gaG9tZXdvcmtcIiwgXCIyMDIzLTAxLTE5XCIpKTtcbmFUb2RvTGlzdC5nZXRBUHJvamVjdChcIm1haW5cIikuYWRkVGFzayhuZXcgVGFzayhcImdldCByaXp6XCIsIFwiMjAyMy0wMS0xOVwiKSk7XG5hVG9kb0xpc3RcbiAgLmdldEFQcm9qZWN0KFwibWFpblwiKVxuICAuYWRkVGFzayhuZXcgVGFzayhcIkdvIHJvY2sgY2xpbWJpbmdcIiwgXCIyMDI0LTAyLTIxXCIpKTtcblxuZXhwb3J0IGRlZmF1bHQgYVRvZG9MaXN0O1xuIiwiaW1wb3J0IE5hdmJhciBmcm9tIFwiLi9uYXZiYXJcIjtcbmltcG9ydCBtYWluQ29udGVudFVJIGZyb20gXCIuL21haW5Db250ZW50XCI7XG5pbXBvcnQgYVRvZG9MaXN0IGZyb20gXCIuL3RvZG9MaXN0XCI7XG5pbXBvcnQgVGFzayBmcm9tIFwiLi90YXNrXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFVJQ29udHJvbGxlciB7XG4gIHN0YXRpYyBsb2FkUGFnZSgpIHtcbiAgICB0aGlzLmFkZFByb2plY3RMaXN0ZW5lcigpO1xuICAgIHRoaXMucHJvamVjdExpc3RlbmVyKCk7XG4gICAgdGhpcy5hZGRUYXNrTGlzdGVuZXIoKTtcbiAgICB0aGlzLmFkZEN1cnJlbnRQcm9qZWN0cygpO1xuICAgIHRoaXMuZGlmZmVyZW50UHJvamVjdFNlbGVjdGVkKFwibWFpblwiKTtcbiAgICAvLyBjb25zdCBib2R5RGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJvZHlcIik7XG4gICAgLy8gYm9keURpdi5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUhlYWRlcigpKTtcbiAgICAvLyBib2R5RGl2LmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlRm9vdGVyKCkpO1xuICAgIC8vIGJvZHlEaXYuYXBwZW5kQ2hpbGQoTmF2YmFyLmxvYWROYXYoKSk7XG4gICAgLy8gYm9keURpdi5hcHBlbmRDaGlsZChtYWluQ29udGVudC5jcmVhdGVNYWluKCkpO1xuICB9XG5cbiAgc3RhdGljIGN1cnJlbnRQcm9qZWN0T0JKID0gYVRvZG9MaXN0LmdldEFQcm9qZWN0KFwibWFpblwiKTtcblxuICBzdGF0aWMgY3JlYXRlSGVhZGVyKCkge1xuICAgIGNvbnN0IGhlYWRlckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgaGVhZGVyRGl2LmNsYXNzTGlzdCA9IFwiaGVhZGVyXCI7XG4gICAgcmV0dXJuIGhlYWRlckRpdjtcbiAgfVxuXG4gIHN0YXRpYyBjcmVhdGVGb290ZXIoKSB7XG4gICAgY29uc3QgZm9vdGVyRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBmb290ZXJEaXYuY2xhc3NMaXN0ID0gXCJmb290ZXJcIjtcbiAgICByZXR1cm4gZm9vdGVyRGl2O1xuICB9XG5cbiAgc3RhdGljIGFkZFByb2plY3RGb3JtQlROUygpIHtcbiAgICBjb25zdCBzdWJtaXRCVE4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvcm1TdWJtaXRcIik7XG4gICAgY29uc3QgY2FuY2VsQlROID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmb3JtQ2FuY2VsXCIpO1xuICAgIGNvbnN0IGlucHV0RmllbGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2plY3ROYW1lXCIpO1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZFByb2plY3RGb3JtXCIpO1xuICAgIC8vIGNvbnNvbGUubG9nKHByb2plY3RMaXN0RE9NTG9jYXRpb24pO1xuICAgIGlucHV0RmllbGQuZm9jdXMoKTtcblxuICAgIHN1Ym1pdEJUTi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIC8vIGNvbnN0IGxhc3RQcm9qZWN0RE9NID0gcHJvamVjdExpc3RET01bcHJvamVjdExpc3RET00ubGVuZ3RoIC0gMV07XG5cbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmIChcbiAgICAgICAgaW5wdXRGaWVsZC52YWx1ZSAhPT0gXCJcIiAmJlxuICAgICAgICBhVG9kb0xpc3QuZ2V0QVByb2plY3QoaW5wdXRGaWVsZC52YWx1ZSkgPT0gbnVsbFxuICAgICAgKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGlucHV0RmllbGQudmFsdWUpO1xuICAgICAgICBpbnB1dEZpZWxkLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgICAgZm9ybS5yZXBsYWNlV2l0aChOYXZiYXIucmV0dXJuQWRkUHJvamVjdEJUTigpKTtcbiAgICAgICAgdGhpcy5hZGRQcm9qZWN0TGlzdGVuZXIoKTtcblxuICAgICAgICBjb25zdCBwcm9qZWN0TGlzdERPTUxvY2F0aW9uID1cbiAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZGl2I3Byb2plY3RBZGRlclwiKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2cocHJvamVjdExpc3RET01Mb2NhdGlvbik7XG5cbiAgICAgICAgY29uc3QgYVByb2plY3RJdGVtID0gTmF2YmFyLnJldHVyblByb2plY3RJdGVtKGlucHV0RmllbGQudmFsdWUpO1xuICAgICAgICBwcm9qZWN0TGlzdERPTUxvY2F0aW9uLmJlZm9yZShhUHJvamVjdEl0ZW0pO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKGFQcm9qZWN0SXRlbSk7XG4gICAgICAgIC8vIHRoaXMucHJvamVjdExpc3RlbmVyKCk7XG5cbiAgICAgICAgYVRvZG9MaXN0LmFkZFByb2plY3QoaW5wdXRGaWVsZC52YWx1ZSk7XG5cbiAgICAgICAgYVByb2plY3RJdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2coXCJ3b3Jrc1wiKTtcbiAgICAgICAgICB0aGlzLmRpZmZlcmVudFByb2plY3RTZWxlY3RlZChpbnB1dEZpZWxkLnZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjYW5jZWxCVE4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zb2xlLmxvZyhcInRlc3RcIik7XG5cbiAgICAgIGZvcm0ucmVwbGFjZVdpdGgoTmF2YmFyLnJldHVybkFkZFByb2plY3RCVE4oKSk7XG4gICAgICB0aGlzLmFkZFByb2plY3RMaXN0ZW5lcigpO1xuICAgIH0pO1xuICB9XG5cbiAgc3RhdGljIGFkZEN1cnJlbnRQcm9qZWN0cygpIHtcbiAgICBjb25zdCBjdXJyZW50UHJvamVjdHMgPSBhVG9kb0xpc3QuZ2V0UHJvamVjdHNOb3RNYWluKCk7XG4gICAgY29uc29sZS5sb2coY3VycmVudFByb2plY3RzKTtcblxuICAgIGNvbnN0IHByb2plY3RMaXN0RE9NTG9jYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZGl2I3Byb2plY3RBZGRlclwiKTtcbiAgICAvLyBjb25zb2xlLmxvZyhwcm9qZWN0TGlzdERPTUxvY2F0aW9uKTtcblxuICAgIGN1cnJlbnRQcm9qZWN0cy5mb3JFYWNoKChhUHJvamVjdCkgPT4ge1xuICAgICAgY29uc3QgYVByb2plY3RJdGVtID0gTmF2YmFyLnJldHVyblByb2plY3RJdGVtKGFQcm9qZWN0LmdldE5hbWUoKSk7XG4gICAgICBwcm9qZWN0TGlzdERPTUxvY2F0aW9uLmJlZm9yZShhUHJvamVjdEl0ZW0pO1xuICAgICAgYVByb2plY3RJdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwid29ya3NcIik7XG4gICAgICAgIHRoaXMuZGlmZmVyZW50UHJvamVjdFNlbGVjdGVkKGFQcm9qZWN0LmdldE5hbWUoKSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHN0YXRpYyBwcm9qZWN0TGlzdGVuZXIoKSB7XG4gICAgLy8gY29uc3QgYWxsUHJvamVjdHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImRpdiNwcm9qZWN0SXRlbVwiKTtcblxuICAgIGNvbnN0IG1haW5Qcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcmltYXJ5ID4gZGl2Om50aC1jaGlsZCgxKVwiKTtcblxuICAgIG1haW5Qcm9qZWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhhVG9kb0xpc3QuZ2V0QVByb2plY3QoXCJtYWluXCIpKTtcbiAgICAgIC8vIHRoaXMudXBkYXRlTWFpbkRpdlByb2plY3QoXCJtYWluXCIpO1xuICAgICAgdGhpcy5kaWZmZXJlbnRQcm9qZWN0U2VsZWN0ZWQoXCJtYWluXCIpO1xuICAgIH0pO1xuXG4gICAgLy8gYWxsUHJvamVjdHNMaXN0LmZvckVhY2goKGFQcm9qZWN0RE9NKSA9PiB7XG4gICAgLy8gICBhUHJvamVjdERPTS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIC8vICAgICBjb25zdCBwcm9qZWN0TmFtZSA9IGFQcm9qZWN0RE9NLnRleHRDb250ZW50O1xuICAgIC8vICAgICAvLyBjb25zb2xlLmxvZyhwcm9qZWN0TmFtZSk7XG5cbiAgICAvLyAgICAgY29uc29sZS5sb2coYVRvZG9MaXN0LmdldEFQcm9qZWN0KHByb2plY3ROYW1lKSk7XG4gICAgLy8gICB9KTtcbiAgICAvLyB9KTtcbiAgfVxuXG4gIHN0YXRpYyBhZGRQcm9qZWN0TGlzdGVuZXIoKSB7XG4gICAgY29uc3QgYWRkUHJvamVjdERPTSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvamVjdEFkZGVyXCIpO1xuICAgIGFkZFByb2plY3RET00uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGFkZFByb2plY3RET00ucmVwbGFjZVdpdGgoTmF2YmFyLmxvYWRBZGRQcm9qZWN0KCkpO1xuICAgICAgdGhpcy5hZGRQcm9qZWN0Rm9ybUJUTlMoKTtcbiAgICAgIC8vIGFkZFByb2plY3RET00oKTtcbiAgICB9KTtcbiAgfVxuXG4gIHN0YXRpYyB0YXNrTGlzdGVuZXIodGFza0Rpdikge1xuICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IHRhc2tEaXYucXVlcnlTZWxlY3RvcihcIi5kZWxldGVcIik7XG4gICAgY29uc3QgZWRpdEJ1dHRvbiA9IHRhc2tEaXYucXVlcnlTZWxlY3RvcihcIi5lZGl0XCIpO1xuICAgIGNvbnN0IGNoZWNrYm94ID0gdGFza0Rpdi5xdWVyeVNlbGVjdG9yKFwiI2ZpbmlzaGVkVGFza1wiKTtcbiAgICBjb25zdCBjdXJyZW50VGV4dDIgPSB0YXNrRGl2LnF1ZXJ5U2VsZWN0b3IoXCIubm90ZVRleHRcIikudGV4dENvbnRlbnQ7XG5cbiAgICBkZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRhc2tEaXYucmVtb3ZlKCk7XG4gICAgICB0aGlzLmN1cnJlbnRQcm9qZWN0T0JKLnJlbW92ZVRhc2soY3VycmVudFRleHQyKTtcbiAgICB9KTtcblxuICAgIGVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGNvbnN0IGN1cnJlbnQgPSB0YXNrRGl2O1xuICAgICAgLy8gY29uc29sZS5sb2coY3VycmVudC5xdWVyeVNlbGVjdG9yKFwiLm5vdGVUZXh0XCIpKTtcbiAgICAgIGNvbnN0IGN1cnJlbnRUZXh0ID0gdGFza0Rpdi5xdWVyeVNlbGVjdG9yKFwiLm5vdGVUZXh0XCIpLnRleHRDb250ZW50O1xuICAgICAgY29uc3QgY3VycmVudERhdGUgPSB0YXNrRGl2LnF1ZXJ5U2VsZWN0b3IoYGlucHV0W3R5cGU9XCJkYXRlXCJdYCkudmFsdWU7XG4gICAgICBjb25zdCBlZGl0VGFza0Zvcm0gPSBtYWluQ29udGVudFVJLmNyZWF0ZVRhc2tGb3JtKCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKFwiY3VycmVudCBUZXh0XCIsIGN1cnJlbnRUZXh0KTtcbiAgICAgIGNvbnNvbGUubG9nKFwiY3VycmVudCBEYXRlXCIsIGN1cnJlbnREYXRlKTtcblxuICAgICAgZWRpdFRhc2tGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjdGFza1RleHRcIikudmFsdWUgPSBjdXJyZW50VGV4dDtcbiAgICAgIGVkaXRUYXNrRm9ybS5xdWVyeVNlbGVjdG9yKFwiI3Rhc2tEYXRlXCIpLnZhbHVlID0gY3VycmVudERhdGU7XG5cbiAgICAgIC8vIGVkaXRUYXNrRm9ybS5xdWVyeVNlbGVjdG9yKCk7XG5cbiAgICAgIGN1cnJlbnQucmVwbGFjZVdpdGgoZWRpdFRhc2tGb3JtKTtcbiAgICAgIHRoaXMuZWRpdFRhc2tMaXN0ZW5lcihlZGl0VGFza0Zvcm0sIGN1cnJlbnQpO1xuICAgIH0pO1xuXG4gICAgY2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRhc2tEaXYuY2xhc3NMaXN0LnRvZ2dsZShcImNoZWNrZWRcIik7XG4gICAgfSk7XG5cbiAgICAvLyBsZXQ7XG4gIH1cblxuICBzdGF0aWMgbG9naWNVcGRhdGVBVGFzayhjdXJyZW50RE9NLCBuZXdOYW1lLCBuZXdEYXRlKSB7XG4gICAgY29uc3QgY3VycmVudFRleHQgPSBjdXJyZW50RE9NLnF1ZXJ5U2VsZWN0b3IoXCIubm90ZVRleHRcIikudGV4dENvbnRlbnQ7XG4gICAgLy8gY29uc3QgY3VycmVudERhdGUgPSBjdXJyZW50RE9NLnF1ZXJ5U2VsZWN0b3IoYGlucHV0W3R5cGU9XCJkYXRlXCJdYCkudmFsdWU7XG5cbiAgICBjb25zdCBjdXJyZW50VGFzayA9IHRoaXMuY3VycmVudFByb2plY3RPQkouZ2V0VGFzayhjdXJyZW50VGV4dCk7XG4gICAgLy8gdGhpcy5jdXJyZW50UHJvamVjdE9CSi5nZXRUYXNrKGN1cnJlbnRUZXh0KVxuICAgIGN1cnJlbnRUYXNrLnNldE5hbWUobmV3TmFtZSk7XG4gICAgY3VycmVudFRhc2suc2V0RGF0ZShuZXdEYXRlKTtcbiAgfVxuXG4gIHN0YXRpYyBlZGl0VGFza0xpc3RlbmVyKGVkaXRGb3JtLCBjdXJyZW50KSB7XG4gICAgY29uc3QgZm9ybVN1Ym1pdEJUTiA9IGVkaXRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybVN1Ym1pdFwiKTtcbiAgICBjb25zdCBmb3JtQ2FuY2VsQlROID0gZWRpdEZvcm0ucXVlcnlTZWxlY3RvcihcIiNmb3JtQ2FuY2VsXCIpO1xuICAgIGNvbnN0IGZvcm1EYXRlSW5wdXQgPSBlZGl0Rm9ybS5xdWVyeVNlbGVjdG9yKFwiI3Rhc2tEYXRlXCIpO1xuICAgIC8vIGNvbnN0IGZvcm0gPSBlZGl0Rm9ybS5xdWVyeVNlbGVjdG9yKFwiLmFkZFRhc2tGb3JtXCIpO1xuXG4gICAgY29uc3QgZm9ybVRleHRJbnB1dCA9IGVkaXRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjdGFza1RleHRcIik7XG4gICAgZm9ybVN1Ym1pdEJUTi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwienp6elwiKTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmIChmb3JtRGF0ZUlucHV0LnZhbHVlICE9PSBcIlwiICYmIGZvcm1EYXRlSW5wdXQudmFsdWUgIT09IFwiXCIpIHtcbiAgICAgICAgY29uc3QgZGF0ZSA9IGZvcm1EYXRlSW5wdXQudmFsdWU7XG4gICAgICAgIGNvbnN0IHRleHQgPSBmb3JtVGV4dElucHV0LnZhbHVlO1xuXG4gICAgICAgIC8vIGVkaXRGb3JtLnJlcGxhY2VXaXRoKG1haW5Db250ZW50VUkuY3JlYXRlVGFzaygpKTtcbiAgICAgICAgLy8gY29uc3QgYWRkVGFzayA9IGVkaXRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuYWRkVGFza1wiKTtcbiAgICAgICAgdGhpcy5sb2dpY1VwZGF0ZUFUYXNrKGN1cnJlbnQsIHRleHQsIGRhdGUpO1xuICAgICAgICBjb25zdCB0YXNrID0gbWFpbkNvbnRlbnRVSS5jcmVhdGVUYXNrKGRhdGUsIHRleHQpO1xuICAgICAgICBlZGl0Rm9ybS5yZXBsYWNlV2l0aCh0YXNrKTtcbiAgICAgICAgdGhpcy50YXNrTGlzdGVuZXIodGFzayk7XG5cbiAgICAgICAgdGhpcy5jdXJyZW50UHJvamVjdE9CSi5nZXRUYXNrKCk7XG4gICAgICAgIC8vIHRhc2tCVE5TXG5cbiAgICAgICAgLy8gdGhpcy5hZGRUYXNrTGlzdGVuZXIoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBjb25zb2xlLmxvZyhmb3JtU3VibWl0QlROKTtcbiAgICBmb3JtQ2FuY2VsQlROLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZWRpdEZvcm0ucmVwbGFjZVdpdGgoY3VycmVudCk7XG4gICAgICAvLyB0aGlzLmFkZFRhc2tMaXN0ZW5lcigpO1xuICAgICAgdGhpcy50YXNrTGlzdGVuZXIoY3VycmVudCk7XG4gICAgfSk7XG4gIH1cblxuICBzdGF0aWMgZGlmZmVyZW50UHJvamVjdFNlbGVjdGVkKHByb2plY3ROYW1lKSB7XG4gICAgLy8gaWYgdGhlIHRhc2sgZm9ybSBpcyBhY3RpdmUgYW5kIGRpZmZlcmVudCBwcm9qZWN0IHNlbGVjdGVkXG4gICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkVGFza0Zvcm1cIikpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiZXhpc3RzXCIpO1xuICAgICAgY29uc3QgdGhlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkVGFza0Zvcm1cIik7XG4gICAgICBjb25zb2xlLmxvZyh0aGVGb3JtKTtcbiAgICAgIHRoZUZvcm0ucXVlcnlTZWxlY3RvcihcIiNmb3JtQ2FuY2VsXCIpLmNsaWNrKCk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKGFUb2RvTGlzdC5nZXRBUHJvamVjdChwcm9qZWN0TmFtZSkpO1xuICAgIHRoaXMuY3VycmVudFByb2plY3RPQkogPSBhVG9kb0xpc3QuZ2V0QVByb2plY3QocHJvamVjdE5hbWUpO1xuICAgIHRoaXMudXBkYXRlTWFpbkRpdlByb2plY3QocHJvamVjdE5hbWUpO1xuXG4gICAgLy8gY3VycmVudFByb2plY3RPQkogPVxuICB9XG5cbiAgc3RhdGljIHVwZGF0ZU1haW5EaXZQcm9qZWN0KHByb2plY3ROYW1lKSB7XG4gICAgY29uc3QgbWFpbkRPTSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpblwiKTtcbiAgICBtYWluRE9NLmRhdGFzZXQuY3VycmVudFByb2plY3QgPSBwcm9qZWN0TmFtZTtcbiAgICBjb25zb2xlLmxvZyh0aGlzLmN1cnJlbnRQcm9qZWN0T0JKLmdldFRhc2tzKCkpO1xuICAgIGNvbnN0IG9sZFRhc2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImRpdi50YXNrXCIpO1xuICAgIG9sZFRhc2tzLmZvckVhY2goKGFTaW5ndWxhclRhc2spID0+IHtcbiAgICAgIGFTaW5ndWxhclRhc2sucmVtb3ZlKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmN1cnJlbnRQcm9qZWN0T0JKLmdldFRhc2tzKCkuZm9yRWFjaCgoYVRhc2spID0+IHtcbiAgICAgIC8vIG9sZFRhc2tzLnJlbW92ZSgpO1xuICAgICAgY29uc29sZS5sb2coXCJBIHRhc2tcIiwgYVRhc2spO1xuICAgICAgY29uc3QgYWRkVGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkVGFza1wiKTtcbiAgICAgIGNvbnN0IHRhc2sgPSBtYWluQ29udGVudFVJLmNyZWF0ZVRhc2soYVRhc2suZ2V0RGF0ZSgpLCBhVGFzay5nZXROYW1lKCkpO1xuXG4gICAgICB0aGlzLnRhc2tMaXN0ZW5lcih0YXNrKTtcbiAgICAgIGFkZFRhc2suYmVmb3JlKHRhc2spO1xuXG4gICAgICB0aGlzLmFkZFRhc2tMaXN0ZW5lcigpO1xuICAgIH0pO1xuICB9XG5cbiAgc3RhdGljIGFkZEN1cnJlbnRUYXNrcygpIHt9XG5cbiAgc3RhdGljIGZvcm1UYXNrTGlzdGVuZXIoKSB7XG4gICAgY29uc3QgZm9ybVN1Ym1pdEJUTiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybVN1Ym1pdFwiKTtcbiAgICBjb25zdCBmb3JtQ2FuY2VsQlROID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmb3JtQ2FuY2VsXCIpO1xuICAgIGNvbnN0IGZvcm1EYXRlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Rhc2tEYXRlXCIpO1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZFRhc2tGb3JtXCIpO1xuXG4gICAgY29uc3QgZm9ybVRleHRJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGFza1RleHRcIik7XG4gICAgZm9ybVN1Ym1pdEJUTi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwienp6elwiKTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmIChmb3JtRGF0ZUlucHV0LnZhbHVlICE9PSBcIlwiICYmIGZvcm1EYXRlSW5wdXQudmFsdWUgIT09IFwiXCIpIHtcbiAgICAgICAgY29uc3QgZGF0ZSA9IGZvcm1EYXRlSW5wdXQudmFsdWU7XG4gICAgICAgIGNvbnN0IHRleHQgPSBmb3JtVGV4dElucHV0LnZhbHVlO1xuXG4gICAgICAgIGZvcm0ucmVwbGFjZVdpdGgobWFpbkNvbnRlbnRVSS5jcmVhdGVBZGRUYXNrKCkpO1xuICAgICAgICBjb25zdCBhZGRUYXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGRUYXNrXCIpO1xuICAgICAgICBjb25zdCB0YXNrID0gbWFpbkNvbnRlbnRVSS5jcmVhdGVUYXNrKGRhdGUsIHRleHQpO1xuXG4gICAgICAgIHRoaXMudGFza0xpc3RlbmVyKHRhc2spO1xuICAgICAgICBhZGRUYXNrLmJlZm9yZSh0YXNrKTtcblxuICAgICAgICB0aGlzLmFkZFRhc2tMaXN0ZW5lcigpO1xuXG4gICAgICAgIHRoaXMuY3VycmVudFByb2plY3RPQkouYWRkVGFzayhuZXcgVGFzayh0ZXh0LCBkYXRlKSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29uc29sZS5sb2coZm9ybVN1Ym1pdEJUTik7XG4gICAgZm9ybUNhbmNlbEJUTi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGZvcm0ucmVwbGFjZVdpdGgobWFpbkNvbnRlbnRVSS5jcmVhdGVBZGRUYXNrKCkpO1xuICAgICAgdGhpcy5hZGRUYXNrTGlzdGVuZXIoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHN0YXRpYyBhZGRUYXNrTGlzdGVuZXIoKSB7XG4gICAgY29uc3QgYWRkVGFza0RPTSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkVGFza1wiKTtcbiAgICBhZGRUYXNrRE9NLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkVGFza0Zvcm1cIikgPT0gbnVsbCkge1xuICAgICAgICBjb25zdCB0YXNrRm9ybURPTSA9IG1haW5Db250ZW50VUkuY3JlYXRlVGFza0Zvcm0oKTtcbiAgICAgICAgY29uc3QgZGF0ZUlOUFQgPSB0YXNrRm9ybURPTS5xdWVyeVNlbGVjdG9yKFwiaW5wdXQjdGFza0RhdGVcIik7XG4gICAgICAgIGRhdGVJTlBULmZvY3VzKCk7XG4gICAgICAgIGFkZFRhc2tET00ucmVwbGFjZVdpdGgodGFza0Zvcm1ET00pO1xuICAgICAgICAvLyB0aGlzLmFkZFRhc2tMaXN0ZW5lcigpO1xuICAgICAgICB0aGlzLmZvcm1UYXNrTGlzdGVuZXIoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFVJQ29udHJvbGxlciBmcm9tIFwiLi9tb2R1bGVzL3VpQ29udHJvbGxlclwiO1xuaW1wb3J0IFRvZG9MaXN0IGZyb20gXCIuL21vZHVsZXMvdG9kb0xpc3RcIjtcblxuLy8gY29uc29sZS5sb2coYVRvZG9MaXN0LnByb2plY3RzKTtcbi8vXG4vLyBjb25zb2xlLmxvZyhhVG9kb0xpc3QuZ2V0QVByb2plY3QoXCJtYWluXCIpKTtcblxuVUlDb250cm9sbGVyLmxvYWRQYWdlKCk7XG4iXSwibmFtZXMiOlsiTmF2YmFyIiwic3RhdGljIiwiY3JlYXRlQnV0dG9uIiwic3ltYm9sIiwidGV4dCIsImJ1dHRvbiIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInNwYW4iLCJjbGFzc0xpc3QiLCJ0ZXh0Q29udGVudCIsImJ1dHRvblRleHQiLCJjcmVhdGVUZXh0Tm9kZSIsImFwcGVuZENoaWxkIiwiaWQiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0IiwiZm9ybURpdiIsImxhYmVsIiwic2V0QXR0cmlidXRlIiwiaW5uZXJUZXh0IiwiaW5wdXQiLCJyZXF1aXJlZCIsImNvbnNvbGUiLCJsb2ciLCJidXR0b25EaXYiLCJuYW1lIiwicHJvamVjdCIsImFkZFByb2plY3QiLCJtYWluQ29udGVudFVJIiwiZGF0ZVR4dCIsInRhc2tEaXYiLCJ0YXNrSW5mb0RpdiIsImNoZWNrQm94SW5wdCIsImRhdGVJbnB0IiwidmFsdWUiLCJyZWFkT25seSIsInRleHROb2RlIiwiZnVuY3Rpb25EaXYiLCJzcGFuRWRpdCIsInNwYW5EZWxldGUiLCJhZGRUYXNrRGl2IiwiYWRkVGFza0Zvcm0iLCJpbm5lckhUTUwiLCJzdWJtaXRCVE4iLCJxdWVyeVNlbGVjdG9yIiwiY2FuY2VsQlROIiwiUHJvamVjdCIsImNvbnN0cnVjdG9yIiwidGhpcyIsInRhc2tzIiwic2V0TmFtZSIsImdldE5hbWUiLCJnZXRUYXNrcyIsImdldFRhc2siLCJ0YXNrTmFtZSIsImZpbmQiLCJ0YXNrIiwicmVtb3ZlVGFzayIsImZpbHRlciIsImFkZFRhc2siLCJwdXNoIiwiVGFzayIsImRhdGUiLCJkb25lIiwic2V0RGF0ZSIsImdldERhdGUiLCJhVG9kb0xpc3QiLCJwcm9qZWN0cyIsImdldFByb2plY3RzIiwiZ2V0UHJvamVjdHNOb3RNYWluIiwiYVByb2plY3QiLCJnZXRBUHJvamVjdCIsIlVJQ29udHJvbGxlciIsImFkZFByb2plY3RMaXN0ZW5lciIsInByb2plY3RMaXN0ZW5lciIsImFkZFRhc2tMaXN0ZW5lciIsImFkZEN1cnJlbnRQcm9qZWN0cyIsImRpZmZlcmVudFByb2plY3RTZWxlY3RlZCIsImhlYWRlckRpdiIsImZvb3RlckRpdiIsImlucHV0RmllbGQiLCJmb3JtIiwiZm9jdXMiLCJyZXBsYWNlV2l0aCIsInJldHVybkFkZFByb2plY3RCVE4iLCJwcm9qZWN0TGlzdERPTUxvY2F0aW9uIiwiYVByb2plY3RJdGVtIiwicmV0dXJuUHJvamVjdEl0ZW0iLCJiZWZvcmUiLCJjdXJyZW50UHJvamVjdHMiLCJmb3JFYWNoIiwiYWRkUHJvamVjdERPTSIsImxvYWRBZGRQcm9qZWN0IiwiYWRkUHJvamVjdEZvcm1CVE5TIiwiZGVsZXRlQnV0dG9uIiwiZWRpdEJ1dHRvbiIsImNoZWNrYm94IiwiY3VycmVudFRleHQyIiwicmVtb3ZlIiwiY3VycmVudFByb2plY3RPQkoiLCJjdXJyZW50IiwiY3VycmVudFRleHQiLCJjdXJyZW50RGF0ZSIsImVkaXRUYXNrRm9ybSIsImNyZWF0ZVRhc2tGb3JtIiwiZWRpdFRhc2tMaXN0ZW5lciIsInRvZ2dsZSIsImN1cnJlbnRET00iLCJuZXdOYW1lIiwibmV3RGF0ZSIsImN1cnJlbnRUYXNrIiwiZWRpdEZvcm0iLCJmb3JtU3VibWl0QlROIiwiZm9ybUNhbmNlbEJUTiIsImZvcm1EYXRlSW5wdXQiLCJmb3JtVGV4dElucHV0IiwibG9naWNVcGRhdGVBVGFzayIsImNyZWF0ZVRhc2siLCJ0YXNrTGlzdGVuZXIiLCJwcm9qZWN0TmFtZSIsInRoZUZvcm0iLCJjbGljayIsInVwZGF0ZU1haW5EaXZQcm9qZWN0IiwiZGF0YXNldCIsImN1cnJlbnRQcm9qZWN0IiwicXVlcnlTZWxlY3RvckFsbCIsImFTaW5ndWxhclRhc2siLCJhVGFzayIsImNyZWF0ZUFkZFRhc2siLCJhZGRUYXNrRE9NIiwidGFza0Zvcm1ET00iLCJmb3JtVGFza0xpc3RlbmVyIiwibG9hZFBhZ2UiXSwic291cmNlUm9vdCI6IiJ9